<!-- åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ  AI èŠå¤©å…¥å£å’Œæ¨¡æ€æ¡† -->
<!-- AI èŠå¤©å…¥å£ -->
<view 
  class="ai-chat-button" 
  bindtap="onAIChatClick"
>
  <image 
    src="https://attach-sit.oss-cn-shanghai.aliyuncs.com/default/28a14b07da0d4e7684758a48649b5ad9.png?1=1" 
    class="ai-avatar"
  ></image>
</view>

<!-- AI èŠå¤©æ¨¡æ€æ¡† -->
<view class="cu-modal {{showAIChat?'show':''}}">
  <view class="cu-dialog">
    <view class="cu-bar bg-white justify-end">
      <view class="content">AI åŠ©æ‰‹</view>
      <view class="action" bindtap="hideAIChat">
        <text class="cuIcon-close text-red"></text>
      </view>
    </view>
    <scroll-view 
      scroll-y 
      class="chat-messages" 
      scroll-with-animation 
      scroll-into-view="msg-{{messages.length-1}}"
    >
      <block wx:for="{{messages}}" wx:key="index">
        <view 
          id="msg-{{index}}"
          class="chat-message {{item.type === 'user' ? 'user-message' : 'ai-message'}}"
        >
          <image 
            src="{{item.type === 'user' ? userInfo.avatarUrl : 'https://attach-sit.oss-cn-shanghai.aliyuncs.com/default/28a14b07da0d4e7684758a48649b5ad9.png?1=1'}}" 
            class="chat-avatar"
          ></image>
          <view class="message-content">
            <text class="message-text">{{item.content}}</text>
            <view wx:if="{{item.fileUrl}}" class="message-file">
              <image 
                src="{{item.fileUrl}}" 
                mode="aspectFill" 
                class="message-image"
              ></image>
            </view>
          </view>
        </view>
      </block>
    </scroll-view>
    <view class="cu-bar input">
      <view class="input-group">
        <view class="file-upload" bindtap="chooseFile">
          <text class="cuIcon-upload"></text>
        </view>
        <input 
          class="cu-input" 
          placeholder="ðŸ¾ æ‚¨æƒ³é—®å°è‚‰ç†Šä»€ä¹ˆæï½ž" 
          confirm-type="send"
          bindinput="onInputChange"
          bindconfirm="sendMessage"
          value="{{inputMessage}}"
        ></input>
        <view class="send-btn" bindtap="sendMessage">
          <text class="cuIcon-right"></text>
        </view>
      </view>
    </view>
  </view>
</view>